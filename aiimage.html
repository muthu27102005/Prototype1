<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Image Detection - Smart Farming</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #1e3c72 100%);
    min-height: 100vh;
    color: #333;
  }

  /* Simple background pattern */
  .bg-pattern {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
      radial-gradient(circle at 20% 50%, rgba(120, 160, 255, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 120, 160, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 80%, rgba(160, 255, 120, 0.1) 0%, transparent 50%);
    pointer-events: none;
    z-index: 1;
  }

  /* Header */
  header {
    background: rgba(255, 255, 255, 0.95);
    color: #2c3e50;
    font-size: 2.2em;
    font-weight: 700;
    padding: 25px;
    text-align: center;
    box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    position: relative;
    z-index: 10;
  }

  /* Main container */
  #container {
    max-width: 800px;
    margin: 30px auto;
    background: rgba(255, 255, 255, 0.98);
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    position: relative;
    z-index: 10;
  }

  /* Language selector */
  .language-section {
    text-align: center;
    margin-bottom: 30px;
  }

  #langLabel {
    color: #34495e;
    font-size: 1.1em;
    font-weight: 600;
    margin-right: 15px;
  }

  #languageSelect {
    padding: 10px 20px;
    border: 2px solid #3498db;
    border-radius: 10px;
    background: white;
    color: #34495e;
    font-size: 1em;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #languageSelect:focus {
    outline: none;
    border-color: #2980b9;
    box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
  }

  /* Title section */
  .title-section {
    text-align: center;
    margin: 30px 0;
    padding: 25px;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    border-radius: 15px;
    border-left: 5px solid #3498db;
  }

  #aiTitle {
    color: #2c3e50;
    font-size: 2.2em;
    margin-bottom: 10px;
    font-weight: 700;
  }

  #aiDesc {
    font-size: 1.1em;
    color: #7f8c8d;
    line-height: 1.5;
  }

  /* Upload section */
  .upload-section {
    background: #f8f9fa;
    border: 3px dashed #bdc3c7;
    border-radius: 15px;
    padding: 50px 30px;
    margin: 30px 0;
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .upload-section:hover {
    border-color: #3498db;
    background: #ecf0f1;
    transform: translateY(-2px);
  }

  .upload-icon {
    font-size: 3em;
    color: #3498db;
    margin-bottom: 15px;
  }

  .upload-text {
    font-size: 1.3em;
    color: #2c3e50;
    margin-bottom: 10px;
    font-weight: 600;
  }

  .upload-subtext {
    font-size: 1em;
    color: #7f8c8d;
    margin-bottom: 20px;
  }

  #fileInput {
    display: none;
  }

  .file-input-btn {
    background: #3498db;
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 25px;
    font-size: 1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .file-input-btn:hover {
    background: #2980b9;
    transform: translateY(-2px);
  }

  /* Image preview */
  .image-preview {
    display: none;
    margin: 30px 0;
    text-align: center;
  }

  .preview-container {
    display: inline-block;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    border: 3px solid #3498db;
  }

  #previewImg {
    max-width: 100%;
    max-height: 300px;
    display: block;
  }

  /* Loading animation */
  .loading {
    display: none;
    text-align: center;
    margin: 30px 0;
  }

  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #ecf0f1;
    border-top: 4px solid #3498db;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 15px;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .loading-text {
    color: #3498db;
    font-size: 1.2em;
    font-weight: 600;
  }

  /* Results sections */
  .ai-analysis, .results-section {
    display: none;
    background: #f8f9fa;
    border-radius: 15px;
    padding: 25px;
    margin: 25px 0;
    border-left: 5px solid #27ae60;
  }

  .analysis-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }

  .ai-brain {
    font-size: 1.8em;
  }

  .analysis-title {
    font-size: 1.4em;
    color: #2c3e50;
    font-weight: 700;
  }

  .result-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #ecf0f1;
  }

  .result-item:last-child {
    border-bottom: none;
  }

  .result-label {
    font-size: 1.1em;
    color: #2c3e50;
    font-weight: 600;
  }

  .result-value {
    font-size: 1em;
    color: #27ae60;
    font-weight: 600;
  }

  .confidence-bar {
    background: #ecf0f1;
    height: 8px;
    border-radius: 4px;
    overflow: hidden;
    margin: 10px 0;
  }

  .confidence-fill {
    height: 100%;
    background: linear-gradient(90deg, #27ae60, #2ecc71);
    border-radius: 4px;
    transition: width 1s ease;
  }

  /* Action buttons */
  .action-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin: 30px 0;
    flex-wrap: wrap;
  }

  .action-btn {
    background: #3498db;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 25px;
    font-size: 1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 140px;
  }

  .action-btn:hover:not(:disabled) {
    background: #2980b9;
    transform: translateY(-2px);
  }

  .action-btn:disabled {
    background: #bdc3c7;
    cursor: not-allowed;
    transform: none;
  }

  .action-btn.clear {
    background: #e74c3c;
  }

  .action-btn.clear:hover {
    background: #c0392b;
  }

  .action-btn.download {
    background: #27ae60;
  }

  .action-btn.download:hover {
    background: #229954;
  }

  /* Back button */
  #backBtn {
    background: #e67e22;
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 25px;
    font-size: 1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: block;
    margin: 30px auto 0;
  }

  #backBtn:hover {
    background: #d35400;
    transform: translateY(-2px);
  }

  /* Responsive design */
  @media (max-width: 768px) {
    header {
      font-size: 1.8em;
      padding: 20px;
    }

    #container {
      margin: 20px;
      padding: 25px;
    }

    #aiTitle {
      font-size: 1.8em;
    }

    .upload-section {
      padding: 40px 20px;
    }

    .action-buttons {
      flex-direction: column;
      align-items: center;
    }

    .action-btn {
      width: 100%;
      max-width: 250px;
    }

    .language-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
  }

  /* Success message */
  .success-message {
    background: #d4edda;
    color: #155724;
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: center;
    border: 1px solid #c3e6cb;
    display: none;
  }

  /* Recommendations section */
  .recommendations {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 2px solid #ecf0f1;
  }

  .recommendations h4 {
    color: #2c3e50;
    margin-bottom: 15px;
    font-size: 1.2em;
  }

  .recommendation-item {
    padding: 8px 0;
    color: #34495e;
    font-size: 1em;
    line-height: 1.4;
  }

  .recommendation-item::before {
    content: "‚Ä¢ ";
    color: #3498db;
    font-weight: bold;
    margin-right: 8px;
  }
</style>
</head>
<body>
<!-- Simple background pattern -->
<div class="bg-pattern"></div>

<header id="headerText">ü§ñ AI Image Detection</header>

<div id="container">
  <!-- Language Selection -->
  <div class="language-section">
    <label id="langLabel">Select Language:</label>
    <select id="languageSelect" onchange="setLanguage()">
      <option value="en">English</option>
      <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    </select>
  </div>

  <!-- Title Section -->
  <div class="title-section">
    <h2 id="aiTitle">AI Image Detection Module</h2>
    <p id="aiDesc">Upload a crop or disease image for advanced AI analysis and identification.</p>
  </div>

  <!-- Upload Section -->
  <div class="upload-section" onclick="document.getElementById('fileInput').click()">
    <div class="upload-icon">üì∑</div>
    <div class="upload-text" id="uploadText">Click to Upload Image</div>
    <div class="upload-subtext" id="uploadSubtext">Supports JPG, PNG, WebP formats (Max 5MB)</div>
    <input type="file" id="fileInput" accept="image/*" onchange="handleFileUpload(event)">
    <button class="file-input-btn" id="uploadBtn">Choose File</button>
  </div>

  <!-- Image Preview -->
  <div class="image-preview" id="imagePreview">
    <div class="preview-container">
      <img id="previewImg" src="" alt="Preview">
    </div>
  </div>

  <!-- Success Message -->
  <div class="success-message" id="successMessage">
    <span id="successText">Image uploaded successfully! Click "Start AI Detection" to analyze.</span>
  </div>

  <!-- Loading Animation -->
  <div class="loading" id="loadingSection">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">Analyzing image with AI...</div>
  </div>

  <!-- AI Analysis -->
  <div class="ai-analysis" id="aiAnalysis">
    <div class="analysis-header">
      <div class="ai-brain">üß†</div>
      <div class="analysis-title" id="analysisTitle">AI Analysis Results</div>
    </div>
    <div id="analysisResults"></div>
  </div>

  <!-- Results Section -->
  <div class="results-section" id="resultsSection">
    <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">üå± Detection Results</h3>
    <div id="detectionResults"></div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button class="action-btn" id="detectBtn" onclick="startAIDetection()" disabled>
      üîç <span id="detectText">Start AI Detection</span>
    </button>
    <button class="action-btn clear" id="clearBtn" onclick="clearResults()" style="display: none;">
      üóëÔ∏è <span id="clearText">Clear Results</span>
    </button>
    <button class="action-btn download" id="downloadBtn" onclick="downloadReport()" style="display: none;">
      üìÑ <span id="downloadText">Download Report</span>
    </button>
  </div>

  <button id="backBtn" onclick="window.location.href='index.html'">
    ‚¨Ö <span id="backText">Back to Home</span>
  </button>
</div>

<script>
const translations = {
  en: {
    header: "ü§ñ AI Image Detection",
    langLabel: "Select Language:",
    title: "AI Image Detection Module",
    desc: "Upload a crop or disease image for advanced AI analysis and identification.",
    uploadText: "Click to Upload Image",
    uploadSubtext: "Supports JPG, PNG, WebP formats (Max 5MB)",
    uploadBtn: "Choose File",
    detect: "Start AI Detection",
    clear: "Clear Results",
    download: "Download Report",
    back: "Back to Home",
    loading: "Analyzing image with AI...",
    analysisTitle: "AI Analysis Results",
    resultsTitle: "üå± Detection Results",
    confidence: "Confidence",
    recommendations: "Recommendations",
    successText: "Image uploaded successfully! Click \"Start AI Detection\" to analyze.",
    noFileSelected: "Please select an image file first",
    fileTooBig: "File size too large. Please select a file under 5MB",
    invalidFile: "Please select a valid image file"
  },
  ta: {
    header: "ü§ñ ‡Æè.‡Æê. ‡Æ™‡Æü‡ÆÆ‡Øç ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç",
    langLabel: "‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç:",
    title: "‡Æè.‡Æê. ‡Æ™‡Æü‡ÆÆ‡Øç ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø",
    desc: "‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æè.‡Æê. ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æü‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡Ææ‡Æï ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æ®‡Øã‡ÆØ‡Øç ‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç.",
    uploadText: "‡Æ™‡Æü‡ÆÆ‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ± ‡Æï‡Æø‡Æ≥‡Æø‡Æï‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç",
    uploadSubtext: "JPG, PNG, WebP ‡Æµ‡Æü‡Æø‡Æµ‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡ÆÜ‡Æ§‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ (‡ÆÖ‡Æ§‡Æø‡Æï‡Æ™‡Æü‡Øç‡Æö‡ÆÆ‡Øç 5MB)",
    uploadBtn: "‡Æï‡Øã‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ",
    detect: "‡Æè.‡Æê. ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ",
    clear: "‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æ¥‡Æø",
    download: "‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Æø‡Æ±‡Æï‡Øç‡Æï‡ÆÆ‡Øç",
    back: "‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Æµ‡ØÅ‡ÆÆ‡Øç",
    loading: "‡Æè.‡Æê. ‡ÆÆ‡ØÇ‡Æ≤‡ÆÆ‡Øç ‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...",
    analysisTitle: "‡Æè.‡Æê. ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç",
    resultsTitle: "üå± ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç",
    confidence: "‡Æ®‡ÆÆ‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Øà",
    recommendations: "‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç",
    successText: "‡Æ™‡Æü‡ÆÆ‡Øç ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Æ∞‡ÆÆ‡Ææ‡Æï ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ! ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ \"‡Æè.‡Æê. ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï‡ØÅ\" ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡Øà‡Æï‡Øç ‡Æï‡Æø‡Æ≥‡Æø‡Æï‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç.",
    noFileSelected: "‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Æø‡Æ≤‡Øç ‡Æí‡Æ∞‡ØÅ ‡Æ™‡Æü‡Æï‡Øç ‡Æï‡Øã‡Æ™‡Øç‡Æ™‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
    fileTooBig: "‡Æï‡Øã‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Øç ‡ÆÖ‡Æ≥‡Æµ‡ØÅ ‡ÆÆ‡Æø‡Æï ‡ÆÖ‡Æ§‡Æø‡Æï‡ÆÆ‡Øç. 5MB ‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÄ‡Æ¥‡Øç ‡Æï‡Øã‡Æ™‡Øç‡Æ™‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
    invalidFile: "‡Æö‡ØÜ‡Æ≤‡Øç‡Æ≤‡ØÅ‡Æ™‡Æü‡Æø‡ÆØ‡Ææ‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æü‡Æï‡Øç ‡Æï‡Øã‡Æ™‡Øç‡Æ™‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç"
  }
};

let currentFile = null;
let analysisData = null;

// Handle file upload
function handleFileUpload(event) {
  const file = event.target.files[0];
  const lang = document.getElementById("languageSelect").value;
  const t = translations[lang];
  
  if (!file) return;
  
  // Validate file size (5MB limit)
  if (file.size > 5 * 1024 * 1024) {
    alert(t.fileTooBig);
    return;
  }
  
  // Validate file type
  if (!file.type.startsWith('image/')) {
    alert(t.invalidFile);
    return;
  }
  
  currentFile = file;
  
  // Show image preview
  const reader = new FileReader();
  reader.onload = function(e) {
    const previewImg = document.getElementById('previewImg');
    const imagePreview = document.getElementById('imagePreview');
    const successMessage = document.getElementById('successMessage');
    
    previewImg.src = e.target.result;
    imagePreview.style.display = 'block';
    successMessage.style.display = 'block';
    
    // Enable detect button
    document.getElementById('detectBtn').disabled = false;
    
    // Scroll to preview
    imagePreview.scrollIntoView({ behavior: 'smooth', block: 'center' });
  };
  
  reader.readAsDataURL(file);
}

// Start AI detection simulation
function startAIDetection() {
  if (!currentFile) {
    const lang = document.getElementById("languageSelect").value;
    alert(translations[lang].noFileSelected);
    return;
  }
  
  // Hide success message
  document.getElementById('successMessage').style.display = 'none';
  
  // Show loading
  document.getElementById('loadingSection').style.display = 'block';
  document.getElementById('detectBtn').disabled = true;
  
  // Scroll to loading
  document.getElementById('loadingSection').scrollIntoView({ behavior: 'smooth', block: 'center' });
  
  // Simulate AI processing
  setTimeout(() => {
    simulateAIAnalysis();
  }, 3000);
}

// Simulate AI analysis results
function simulateAIAnalysis() {
  const lang = document.getElementById("languageSelect").value;
  const t = translations[lang];
  
  // Hide loading
  document.getElementById('loadingSection').style.display = 'none';
  
  // Generate mock analysis data
  const diseases = [
    { name: lang === 'ta' ? '‡Æá‡Æ≤‡Øà‡Æï‡Øç ‡Æï‡Æ∞‡ØÅ‡Æï‡Æ≤‡Øç' : 'Leaf Blight', confidence: 92 },
    { name: lang === 'ta' ? '‡Æ§‡ØÅ‡Æ∞‡ØÅ ‡Æ®‡Øã‡ÆØ‡Øç' : 'Rust Disease', confidence: 78 },
    { name: lang === 'ta' ? '‡Æ™‡Ææ‡Æï‡Øç‡Æü‡ØÄ‡Æ∞‡Æø‡ÆØ‡Ææ ‡Æµ‡Ææ‡Æü‡Æ≤‡Øç' : 'Bacterial Wilt', confidence: 45 }
  ];
  
  const recommendations = lang === 'ta' ? [
    '‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æ™‡ØÇ‡Æû‡Øç‡Æö‡Ææ‡Æ£ ‡Æï‡Øä‡Æ≤‡Øç‡Æ≤‡Æø ‡ÆÆ‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æ§‡ØÜ‡Æ≥‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç',
    '‡Æ™‡Ææ‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æµ‡Æü‡Æø‡Æï‡Ææ‡Æ≤‡Øç ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç',
    '‡Æ®‡Øã‡ÆØ‡Øç‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ§‡Ææ‡Æµ‡Æ∞ ‡Æ™‡Ææ‡Æï‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æï‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç',
    '‡Æµ‡Ææ‡Æ∞‡Æ®‡Øç‡Æ§‡Øã‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Ææ‡Æµ‡Æ∞ ‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ‡Æ§‡Øç‡Æ§‡Øà ‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç'
  ] : [
    'Apply fungicide treatment immediately',
    'Improve drainage in affected areas',
    'Remove infected plant parts',
    'Monitor plant health weekly'
  ];
  
  analysisData = {
    diseases,
    recommendations,
    healthScore: 65,
    confidence: diseases[0].confidence
  };
  
  displayResults();
}

// Display analysis results
function displayResults() {
  const lang = document.getElementById("languageSelect").value;
  const t = translations[lang];
  
  // Show AI analysis section
  const aiAnalysis = document.getElementById('aiAnalysis');
  aiAnalysis.style.display = 'block';
  
  // Show results section
  const resultsSection = document.getElementById('resultsSection');
  resultsSection.style.display = 'block';
  
  // Populate results
  const detectionResults = document.getElementById('detectionResults');
  detectionResults.innerHTML = '';
  
  // Add detected diseases
  analysisData.diseases.forEach((disease) => {
    const resultItem = document.createElement('div');
    resultItem.className = 'result-item';
    resultItem.innerHTML = `
      <div class="result-label">${disease.name}</div>
      <div class="result-value">${disease.confidence}% ${t.confidence}</div>
    `;
    detectionResults.appendChild(resultItem);
    
    // Add confidence bar
    const confidenceBar = document.createElement('div');
    confidenceBar.className = 'confidence-bar';
    const confidenceFill = document.createElement('div');
    confidenceFill.className = 'confidence-fill';
    confidenceFill.style.width = disease.confidence + '%';
    confidenceBar.appendChild(confidenceFill);
    detectionResults.appendChild(confidenceBar);
  });
  
  // Add recommendations
  const recSection = document.createElement('div');
  recSection.className = 'recommendations';
  recSection.innerHTML = `<h4>${t.recommendations}:</h4>`;
  analysisData.recommendations.forEach(rec => {
    const recItem = document.createElement('div');
    recItem.className = 'recommendation-item';
    recItem.textContent = rec;
    recSection.appendChild(recItem);
  });
  detectionResults.appendChild(recSection);
  
  // Show action buttons
  document.getElementById('clearBtn').style.display = 'inline-block';
  document.getElementById('downloadBtn').style.display = 'inline-block';
  
  // Update analysis results
  const analysisResults = document.getElementById('analysisResults');
  analysisResults.innerHTML = `
    <div class="result-item">
      <div class="result-label">${lang === 'ta' ? '‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÜ‡Æ£‡Øç' : 'Health Score'}</div>
      <div class="result-value">${analysisData.healthScore}%</div>
    </div>
    <div class="result-item">
      <div class="result-label">${lang === 'ta' ? '‡ÆÆ‡ØÅ‡Æ§‡Æ©‡Øç‡ÆÆ‡Øà ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç' : 'Primary Detection'}</div>
      <div class="result-value">${analysisData.diseases[0].name}</div>
    </div>
    <div class="result-item">
      <div class="result-label">${lang === 'ta' ? '‡Æí‡Æü‡Øç‡Æü‡ØÅ‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æ®‡ÆÆ‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Øà' : 'Overall Confidence'}</div>
      <div class="result-value">${analysisData.confidence}%</div>
    </div>
  `;
  
  // Scroll to results
  aiAnalysis.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Clear all results
function clearResults() {
  document.getElementById('imagePreview').style.display = 'none';
  document.getElementById('successMessage').style.display = 'none';
  document.getElementById('aiAnalysis').style.display = 'none';
  document.getElementById('resultsSection').style.display = 'none';
  document.getElementById('clearBtn').style.display = 'none';
  document.getElementById('downloadBtn').style.display = 'none';
  document.getElementById('detectBtn').disabled = true;
  document.getElementById('fileInput').value = '';
  currentFile = null;
  analysisData = null;
  
  // Scroll back to upload section
  document.querySelector('.upload-section').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// Download report
function downloadReport() {
  if (!analysisData) return;
  
  const report = {
    timestamp: new Date().toISOString(),
    diseases: analysisData.diseases,
    recommendations: analysisData.recommendations,
    healthScore: analysisData.healthScore
  };
  
  const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `ai-detection-report-${Date.now()}.json`;
  a.click();
  URL.revokeObjectURL(url);
}

// Set language
function setLanguage() {
  const lang = document.getElementById("languageSelect").value;
  const t = translations[lang];
  
  document.getElementById("headerText").innerText = t.header;
  document.getElementById("langLabel").innerText = t.langLabel;
  document.getElementById("aiTitle").innerText = t.title;
  document.getElementById("aiDesc").innerText = t.desc;
  document.getElementById("uploadText").innerText = t.uploadText;
  document.getElementById("uploadSubtext").innerText = t.uploadSubtext;
  document.getElementById("uploadBtn").innerText = t.uploadBtn;
  document.getElementById("detectText").innerText = t.detect;
  document.getElementById("clearText").innerText = t.clear;
  document.getElementById("downloadText").innerText = t.download;
  document.getElementById("backText").innerText = t.back;
  document.getElementById("loadingText").innerText = t.loading;
  document.getElementById("analysisTitle").innerText = t.analysisTitle;
  document.getElementById("successText").innerText = t.successText;
}

// Initialize page
document.addEventListener("DOMContentLoaded", function() {
  setLanguage();
  
  // Add drag and drop functionality
  const uploadSection = document.querySelector('.upload-section');
  
  uploadSection.addEventListener('dragover', function(e) {
    e.preventDefault();
    this.style.borderColor = '#3498db';
    this.style.backgroundColor = '#ecf0f1';
  });
  
  uploadSection.addEventListener('dragleave', function(e) {
    e.preventDefault();
    this.style.borderColor = '#bdc3c7';
    this.style.backgroundColor = '#f8f9fa';
  });
  
  uploadSection.addEventListener('drop', function(e) {
    e.preventDefault();
    this.style.borderColor = '#bdc3c7';
    this.style.backgroundColor = '#f8f9fa';
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      document.getElementById('fileInput').files = files;
      handleFileUpload({ target: { files: files } });
    }
  });
});
</script>
</body>
</html>
